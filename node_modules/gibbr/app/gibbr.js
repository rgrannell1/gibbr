
"use strict"





require('babel-polyfill')
var is = require('is')





var renameInodes = require('gibbr/fs/rename-inodes')





var gibbr = rawArgs => {

	renameInodes( gibbr.preproccess(gibbr.validate(rawArgs)) )

}

gibbr.validate = args => {
	return args
}

gibbr.preproccess = rawArgs => {

	try {

		var size = parseInt(rawArgs.X, 10)

	} catch (err) {
		throw new Error('failed to parse "--size" argument.')
	}

	if (size !== size) {
		throw Error('"--size" was NaN.')
	}

	if (size < 0) {
		throw Error('"--size" must be larger than zero.')
	}

	is.always.boolean(rawArgs['--no-preserve-root'])

	var args = Object.assign({

		files:      rawArgs['<path>'],
		size:       size,
		shouldNuke: rawArgs['--no-preserve-root']

	}, rawArgs)

	return args

}





module.exports = gibbr
